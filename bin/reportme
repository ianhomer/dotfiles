#!/usr/bin/env python3

#
# Report on configuration
#

import os, sys, getopt, subprocess
from pathlib import Path

def usage():
  scriptName = os.path.basename(__file__)
  print(f"{scriptName} -h|b")

def heading(heading, separator = "-"):
  if (separator == "-"):
    print()
  print(heading)
  print(separator * 40)

def reportBrew():
  heading("Brew")
  os.system("brew leaves | column -c 80")

def reportFish():
  heading("fish")
  heading("omf",".")
  os.system("fish -c 'omf list'")

def main(argv):
  heading("dotfiles System Report"," ")
  all = True
  try:
    opts, argv = getopt.getopt(argv,
      "hb",["brew","fish"]
    )
  except getopt.GetoptError:
    print(e)
    usage()
    sys.exit(2)
  for opt, arg in opts:
    all = False
    if opt == '-h':
      usage()
      sys.exit()
    elif opt == '--brew':
      reportBrew()
    elif opt == '--fish':
      reportFish()

  if (all):
    reportFish()
    reportBrew()
if __name__ == "__main__":
  main(sys.argv[1:])
