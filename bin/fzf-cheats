#!/usr/bin/env python3

#
# Generate cheats for streaming into fzf
#

import os, re, sys, fileinput, getopt
from pathlib import Path

def usage():
  scriptName = os.path.basename(__file__)
  print(f"{scriptName}")

lineFormat = "{command:10s} {definition:20s}"

def printLine(meta):
  print(lineFormat.format(**meta))

metas = []

application = "default"
context = "main"
mark = ""
command = "n/a"
defintion = "definition"

DEBUG=1

def parse(line):
  if DEBUG: print("line : " + line)
  match = re.search('^(#+) (.*)$', line)
  if match:
    if DEBUG: print("heading : " + match.group(1) + ":" + match.group(2))
    headingDepth=len(match.group(1))
    if headingDepth == 2:
      application = match.group(2)
    else:
      context = match.group(2)
    return
  match = re.search('\*\*([^\*]*)\*\*', line)
  if match:
    if DEBUG: print("command " + match.group(1))
    command = match.group(1)


def main(argv):
  metas.append({"command":"x", "definition":"des"})
  for line in fileinput.input():
    parse(line.rstrip())

  for meta in metas:
    printLine(meta)

if __name__ == "__main__":
  main(sys.argv[1:])

