#!/usr/bin/env bash

# Install apps
#
# Alternative approach to brew where brew is not appropriate, e.g. with cask in
# brew that requires admin password to install (and hence requires user
# interaction)
#

set -e
$(shim) && cd ${ME} && . bin/i.sh
should-run -m 7 $@ $0 || exit 0

if ! command -v gcloud ; then
  log:: "gcloud is not installed"
  downloaded=~/local/gcloud/google-cloud-cli*.tar.gz
  if [[ -f "${downloaded}" ]] ; then
    log:: "Download latest tar.gz from https://cloud.google.com/sdk/docs/install-sdk to ~/local/gcloud"
    log:: "... cd ~/local/gcloud ; curl -O URL"
    log:: "... and then rerun this"
    mkdir -p ~/local/gcloud
  else
    cd ~/local/gcloud
    echo "Installing from "${downloaded}
    tar xvf ${downloaded}
  fi
fi

should-run -fu $0
