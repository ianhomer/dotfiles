#!/bin/bash

# Show a concise report of git status
function showDirectoryStatus {
  #printf '\033[1;33m'
  #echo "-->"
  printf '\033[0;35m'
  git rev-parse --show-toplevel
  printf '\033[0;37m'
  git branch -v | grep "\[ahead\|\[behind"

  printf '\033[0m'
  git status --porcelain
}

# Scan sub directories for git repository to report on
function showDirectoryStatusWithFind {
  if [ -d .git ] ; then
    showDirectoryStatus
  else
   for d in */ ; do
     if [ -d $d/.git ] ; then
       (cd $d ; showDirectoryStatus)
     fi
   done
  fi
}

# Show status of core repositories
cd ~/.dotfiles
showDirectoryStatus
cd ~/projects/things
showDirectoryStatusWithFind

# Show status of recently entered directories
for d in `fasd -ldR | head -n 10 | grep "$HOME/projects" | grep -v things` ; do
  (cd $d ; showDirectoryStatus)
done
